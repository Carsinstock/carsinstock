{% extends "base.html" %}
{% block content %}
<div class="search-page">
    <h1>Search Cars</h1>
    <form method="GET" action="/search-cars" class="search-form">
        <input type="text" name="q" value="{{ query or '' }}" placeholder="Search by make, model, year, color..." class="search-input">
        <button type="submit" class="search-btn">Search</button>
    </form>

    {% if query %}
        {% if vehicles %}
        <p class="search-count">{{ vehicles|length }} vehicle{{ 's' if vehicles|length != 1 else '' }} found for "{{ query }}"</p>
        <div class="search-results">
            {% for v in vehicles %}
            <div class="search-card">
                {% if v.image_url %}
                <img src="{{ v.image_url }}" alt="{{ v.year }} {{ v.make }} {{ v.model }}" class="search-card-img">
                {% else %}
                <div class="search-card-img search-no-photo">No Photo</div>
                {% endif %}
                <div class="search-card-info">
                    <h3>{{ v.year }} {{ v.make }} {{ v.model }}{% if v.trim %} {{ v.trim }}{% endif %}</h3>
                    <p class="search-card-price">${{ "{:,.0f}".format(v.price) }}</p>
                    {% if v.mileage %}<p class="search-card-detail">{{ "{:,}".format(v.mileage) }} miles</p>{% endif %}
                    {% if v.exterior_color %}<p class="search-card-detail">{{ v.exterior_color }}</p>{% endif %}
                    {% if v.transmission %}<p class="search-card-detail">{{ v.transmission }}</p>{% endif %}
                    <p class="search-card-seller">Sold by: {{ v.salesperson.display_name }}</p>
                    <a href="/{{ v.salesperson.profile_url_slug }}" class="search-card-btn">View Storefront</a>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="search-empty">
            <p>No vehicles found for "{{ query }}"</p>
            <p>Try a different search â€” like a make (Jeep), model (Wrangler), or year (2022).</p>
        </div>
        {% endif %}
    {% else %}
    <div class="search-empty">
        <p>Search for vehicles across all CarsInStock storefronts.</p>
        <p>Try searching by make, model, year, or color.</p>
    </div>
    {% endif %}
</div>

<style>
.search-page { max-width: 900px; margin: 30px auto; padding: 0 20px; }
.search-page h1 { color: #2d1d36; margin-bottom: 20px; }
.search-form { display: flex; gap: 10px; margin-bottom: 25px; }
.search-input { flex: 1; padding: 14px 18px; border: 2px solid #ddd; border-radius: 10px; font-size: 16px; outline: none; transition: border-color 0.2s; }
.search-input:focus { border-color: #6C2BD9; }
.search-btn { padding: 14px 30px; background: #6C2BD9; color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer; }
.search-btn:hover { background: #5a23b5; }
.search-count { color: #666; font-size: 14px; margin-bottom: 15px; }
.search-results { display: flex; flex-direction: column; gap: 15px; }
.search-card { display: flex; gap: 20px; background: #fff; border: 1px solid #eee; border-radius: 12px; padding: 15px; box-shadow: 0 1px 4px rgba(0,0,0,0.04); }
.search-card:hover { border-color: #6C2BD9; box-shadow: 0 2px 8px rgba(108,43,217,0.1); }
.search-card-img { width: 200px; height: 140px; border-radius: 8px; object-fit: cover; flex-shrink: 0; }
.search-no-photo { background: #f5f5f5; display: flex; align-items: center; justify-content: center; color: #ccc; font-size: 14px; }
.search-card-info { flex: 1; display: flex; flex-direction: column; gap: 4px; }
.search-card-info h3 { color: #333; font-size: 18px; margin: 0; }
.search-card-price { color: #6C2BD9; font-size: 20px; font-weight: 700; margin: 4px 0; }
.search-card-detail { color: #666; font-size: 14px; margin: 0; }
.search-card-seller { color: #999; font-size: 13px; margin-top: 8px; }
.search-card-btn { display: inline-block; margin-top: 8px; padding: 8px 20px; background: #6C2BD9; color: white; border-radius: 6px; text-decoration: none; font-size: 14px; font-weight: 600; width: fit-content; }
.search-card-btn:hover { background: #5a23b5; }
.search-empty { text-align: center; padding: 50px 20px; color: #999; }
.search-empty p { margin: 8px 0; font-size: 16px; }
@media (max-width: 768px) {
    .search-form { flex-direction: column; }
    .search-card { flex-direction: column; }
    .search-card-img { width: 100%; height: 200px; }
}
</style>
{% endblock %}
