{% extends "base.html" %}

{% block title %}{{ salesperson.name }} â€“ CarsInStock{% endblock %}

{% block content %}

<div class="top-bar">
    <span>CarsInStock demo profile Â· Powered by Eddieâ€™s platform</span>
    <span>Secure Â· Mobile friendly Â· Lead ready</span>
</div>

<header class="hero">
    <div class="hero-left">
        <div class="avatar">
            {{ salesperson.name[0:1] }}{{ salesperson.name.split(' ')[-1][0:1] }}
        </div>

        <div class="hero-main">
            <h1>{{ salesperson.name }}</h1>

            <div class="hero-verification">
                <span class="verified-badge">âœ” Verified CarsInStock Seller</span>
            </div>

            <p class="hero-location">
                {{ salesperson.dealership }} Â· {{ salesperson.city }}, {{ salesperson.state }}
            </p>

            <div class="hero-tagline">
                â–¶ Top rated Â· {{ salesperson.tagline }}
            </div>
        </div>
    </div>

    <div class="hero-right">
        <div class="hero-card">
            <div class="hero-card-title">Talk to {{ salesperson.name.split(' ')[0] }}</div>

            <div class="hero-card-main">
                <span>Real person, real options.</span><br>
                <small>{{ salesperson.hours or "Monâ€“Sat 9amâ€“7pm" }}</small>
            </div>

            <div class="hero-buttons">
                <button class="btn-primary">ğŸ“ Call {{ salesperson.phone }}</button>
                <button class="btn-outline">âœ‰ï¸ Text / Message</button>
            </div>
        </div>
    </div>
</header>

<div class="search-row">
    <div class="lead-box">
        <form method="POST" action="/lead">
            <input
                class="lead-input"
                type="text"
                name="lead_info"
                placeholder="Enter your name & email to get {{ salesperson.name.split(' ')[0] }}â€™s best deals firstâ€¦"
                required
            />
            <button class="lead-btn" type="submit">Join VIP Deal List</button>
        </form>

        <a href="#inventory-section" class="view-all-link">View my posted cars â†’</a>
    </div>
</div>

<div class="main-row">

    <!-- LEFT COLUMN â€” INVENTORY -->
    <section id="inventory-section" class="inventory-col">
        <div class="section-header">
            <h2 id="countdown-title">My Best Picks In Stock â€” Loading...</h2>
            <span>{{ inventory|length }} vehicles</span>
        </div>

        <div class="inventory-grid">
            {% for car in inventory %}
            <article class="car-card">
                <div class="car-image"></div>
                <div class="car-body">
                    <div class="car-title">
                        {{ car.year }} {{ car.make }} {{ car.model }}
                    </div>
                    <div class="car-meta">
                        {{ car.miles }} miles Â· {{ car.trim }}
                    </div>
                    <div class="car-footer">
                        <div class="car-price">{{ car.price }}</div>
                        <div class="car-cta">View details â†’</div>
                    </div>
                </div>
            </article>
            {% endfor %}
        </div>
    </section>

    <!-- RIGHT COLUMN â€” SIDEBAR -->
    <aside class="sidebar-col">

        <!-- About block -->
        <div class="sidebar-block">
            <div class="sidebar-title">About {{ salesperson.name.split(' ')[0] }}</div>
            <div class="sidebar-text">
                {{ salesperson.bio }}
            </div>
        </div>

        <!-- Reviews block -->
        <div class="sidebar-block sidebar-reviews">
            <div class="sidebar-title">What people say</div>
            <div class="review-stars">â˜…â˜…â˜…â˜…â˜…</div>
            <p class="review-quote">
                "Hands down the easiest car deal Iâ€™ve ever done."
            </p>
            <p class="review-source">
                â€“ Google review
            </p>
            <a href="#" class="review-link">See more Google reviews â†’</a>
        </div>

        <!-- Contact block -->
        <div class="sidebar-block">
            <div class="sidebar-title">Contact & Hours</div>
            <div class="sidebar-text">
                Phone: {{ salesperson.phone }}<br>
                Email: {{ salesperson.email }}<br>
                Hours: {{ salesperson.hours or "Monâ€“Sat 9amâ€“7pm" }}<br>
                Market: {{ salesperson.city }}, {{ salesperson.state }}
            </div>
        </div>

    </aside>

</div>

<!-- COUNTDOWN TIMER -->
<script>
    const totalDays = 3;

    let startDate = localStorage.getItem("cis_start_date");
    if (!startDate) {
        startDate = new Date().getTime();
        localStorage.setItem("cis_start_date", startDate);
    }

    const now = new Date().getTime();
    const daysPassed = Math.floor((now - startDate) / (1000 * 60 * 60 * 24));
    let daysLeft = totalDays - daysPassed;
    if (daysLeft < 0) daysLeft = 0;

    const headerEl = document.querySelector("#countdown-title");
    if (headerEl) {
        if (daysLeft > 1) {
            headerEl.textContent = `My Best Picks In Stock â€” These Links Expire in ${daysLeft} Days!`;
        } else if (daysLeft === 1) {
            headerEl.textContent = `My Best Picks In Stock â€” These Links Expire in 1 Day!`;
        } else {
            headerEl.textContent = "My Best Picks In Stock â€” These Links Expire Today!";
        }
    }
</script>

{% endblock %}
